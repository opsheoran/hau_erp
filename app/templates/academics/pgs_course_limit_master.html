{% extends "base.html" %}
{% block content %}
<style>
    .textbox-small { width: 150px !important; }
    .textbox-medium { width: 250px !important; }
    .textarea-medium { width: 363px !important; height: 60px !important; }
    .required-star { color: red; font-weight: bold; }
</style>

<!-- SAVE FORM -->
<form method="POST" id="saveForm">
    <input type="hidden" name="action" value="SAVE">
    <input type="hidden" name="pk_id" id="pk_id">
    
    <table border="0" class="form-table" width="100%" cellspacing="0" cellpadding="0">
        <tbody>
            <tr>
                <td class="tableheading" colspan="6">
                    <span class="mainheadingborderbottom">Session Wise PGS Course Limit</span>
                </td>
            </tr>
            <tr><td colspan="6" height="15"></td></tr>
            
            <tr>
                <td class="vtext" width="15%">College</td>
                <td class="colon">:</td>
                <td class="required">
                    <select name="college_id" id="ddlColleges" class="dropdown textbox-medium">
                        <option value="0">--Select College--</option>
                        {% for c in colleges %}
                        <option value="{{ c.id }}">{{ c.name }}</option>
                        {% endfor %}
                    </select>
                    <span class="required-star">*</span>
                </td>
                <td colspan="3"></td>
            </tr>
            
            <tr>
                <td class="vtext">Course Name</td>
                <td class="colon">:</td>
                <td class="required">
                    <select name="course_id" id="ddlCourseName" class="dropdown textbox-medium" required>
                        <option value="">--Select Course--</option>
                        {% for c in courses %}
                        <option value="{{ c.id }}">{{ c.name }}</option>
                        {% endfor %}
                    </select>
                    <span class="required-star">*</span>
                </td>
                <td colspan="3"></td>
            </tr>
            
            <tr>
                <td class="vtext">Session</td>
                <td class="colon">:</td>
                <td class="required">
                    <select name="session_id" id="ddlSessionFrom" class="dropdown textbox-small" required>
                        <option value="">Select Session</option>
                        {% for s in sessions %}
                        <option value="{{ s.id }}">{{ s.name }}</option>
                        {% endfor %}
                    </select>
                    <span class="required-star">*</span>
                </td>
                <td colspan="3"></td>
            </tr>
            
            <tr>
                <td class="vtext">Class</td>
                <td class="colon">:</td>
                <td class="required">
                    <select name="class_id" id="ddlSemester" class="dropdown textbox-small" required>
                        <option value="">--Select Class--</option>
                        <option value="1">Odd Semester</option>
                        <option value="2">Even Semester</option>
                    </select>
                    <span class="required-star">*</span>
                </td>
                <td colspan="3"></td>
            </tr>
            
            <tr>
                <td class="vtext">Capacity</td>
                <td class="colon">:</td>
                <td class="required">
                    <input name="capacity" type="number" id="txtCapacity" class="textbox textbox-small" required>
                    <span class="required-star">*</span>
                </td>
                <td colspan="3"></td>
            </tr>
            
            <tr><td colspan="6" height="15"></td></tr>
            
            <tr>
                <td colspan="2"></td>
                <td colspan="4">
                    <input type="submit" value="SAVE" class="button-common">
                    <input type="button" value="RESET" class="button-common" onclick="resetForm()">
                </td>
            </tr>
        </tbody>
    </table>
</form>

<br>

<!-- LIST VIEW -->
<table border="0" class="form-table" width="100%" cellspacing="0" cellpadding="0">
    <tbody>
        <tr>
            <td class="tablesubheading" colspan="6">
                <span class="subheadingborderbottom">PGS Course(s) Details List</span>
            </td>
        </tr>
        <tr><td colspan="6" height="10"></td></tr>
        <tr>
            <td colspan="6">
                <table class="table-grid-view" width="100%">
                    <thead>
                        <tr class="header-style">
                            <th width="5%">S.No.</th>
                            <th>College</th>
                            <th>Course</th>
                            <th>Session</th>
                            <th>Capacity</th>
                            <th width="5%">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in items %}
                        <tr class="{% if loop.index % 2 == 0 %}item-style-alt{% else %}item-style{% endif %}" align="center">
                            <td>{{ (pagination.page - 1) * pagination.per_page + loop.index }}</td>
                            <td align="left">{{ item.collegename }}</td>
                            <td align="left">{{ item.coursename }}</td>
                            <td>{{ item.sessionname }}</td>
                            <td>{{ item.CourseCapacity }}</td>
                            <td>
                                <!-- DELETE FORM IS SEPARATE -->
                                <form method="POST" onsubmit="return confirm('Are you sure you want to delete this course limit for ALL colleges?');" style="display:inline;">
                                    <input type="hidden" name="action" value="DELETE">
                                    <input type="hidden" name="id" value="{{ item.pk_PgsId }}">
                                    <input type="image" src="{{ url_for('static', filename='images/delete.gif') }}" alt="Delete">
                                </form>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="6" align="center" style="color:red; padding:10px;">No records found</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
                
                {% if pagination.total_pages > 1 %}
                <div class="pager-style">
                    {% if pagination.has_prev %}
                        <a href="{{ url_for('academics.pgs_course_limit_master', page=pagination.page-1) }}">&lt;</a>
                    {% else %}
                        <span class="disabled">&lt;</span>
                    {% endif %}

                    {% for p in page_range %}
                        {% if p == '...' %}
                            <span>{{ p }}</span>
                        {% elif p == pagination.page %}
                            <span class="active">{{ p }}</span>
                        {% else %}
                            <a href="{{ url_for('academics.pgs_course_limit_master', page=p) }}">{{ p }}</a>
                        {% endif %}
                    {% endfor %}

                    {% if pagination.has_next %}
                        <a href="{{ url_for('academics.pgs_course_limit_master', page=pagination.page+1) }}">&gt;</a>
                    {% else %}
                        <span class="disabled">&gt;</span>
                    {% endif %}
                </div>
                {% endif %}
            </td>
        </tr>
    </tbody>
</table>

<script>
function resetForm() {
    document.getElementById('pk_id').value = '';
    document.getElementById('saveForm').reset();
}
</script>
{% endblock %}